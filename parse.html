<!--canvas id="c" width=1024 height=256>
</canvas-->
<script src="js/lib/require.js"></script>
<script src="js/reqConf.js"></script>
<script>
requirejs.config(reqConf);
requirejs(["M2Parser","SEnv"],function (P,SEnv) {
    window.senv=new SEnv({useScriptProcessor:false});
    window.play=function () {
        var mzo=P.parseMML(document.querySelector("#mml").value);
        window.senv.load(mzo);
        window.senv.Start();
    };
    window.stop=function () {
        window.senv.Stop();
    };
});
window.onload=function () {
    var s=document.querySelectorAll(".mml");
    var sel=document.querySelector("#samples");
    s.forEach(function (e) {
        var opt=document.createElement("option");
        opt.innerHTML=e.getAttribute("data-name");
        sel.appendChild(opt);
    });
    sel.addEventListener("change", function () {
        selectSample(sel.value);
    });
};
function selectSample(name) {
    var s=document.querySelectorAll(".mml");
    s.forEach(function (e) {
        var opt=document.createElement("option");
        if (e.getAttribute("data-name")===name) {
            document.querySelector("#mml").value=e.innerHTML;
        }
    });

}
</script>
<H1>Enter MML Here</h1>

<div><select id="samples">
</select></div>
<div><textarea id="mml" rows=20 cols=80>
1[v8 c2 def8 ]
</textarea>
<button onclick="play()">Play!</button>
<button onclick="stop()">Stop!</button>
</div>
<script class="mml" type="text/mml" data-name="Fanfare">
1[l16cdeg4]
2[l16efg>c4]
</script>
<script class="mml" type="text/mml" data-name="Ribbon">
1-3[ps5 v6]
1[l16 o3ps10 ]
2[l16ps10]
1[@dt5(cgfd)4]
2[r1]
3[r1]

1-3[@label1]
1[(cgfd)8]
2[     (ec)4 r2 (ge)4 r2 ]
1[(cgfd)4 (dafd)4 ]
2[       (ec)4 r2 (fd)4 r2]
1[(cgfd)8]
2[       (ec)4 r2 (ge)4 r2]
1[(cgfd)2 cfedcgfe (cgfe)4]
2[       (ec)4 gege fddd (c<g>)4 r2 ]

1[(cgfd)8]
2[     (ec)4 r2 (ge)4 r2 ]
1[(cgfd)4 (dafd)4 ]
2[       (ec)4 r2 (fd)4 r2]
1[(cgfd)8]
2[       (ec)4 r2 (ge)4 r2]
1[(cgfd)2 cfedcgfe (cgfe)4]
2[       (ec)4 gege fddd (c<g>)4 r2 ]

3[(r1)8]
3[ps3]
3[ o5 c2 d4e4 e2 d2]
3[    c2 d4e4 d2 r2]
3[ o5 c2 d4e4 e2 d2]
3[    e2 f4d4 c2 r2]
1-3[@jump1]
</script>
